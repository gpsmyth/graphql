#!/usr/bin/env node

const nodemon = require('nodemon');
const path = require('path');
const { once } = require('ramda');
const webpack = require('webpack');
const config = require('../webpack.config');

const compiler = webpack(config);

compiler.watch(
  config.watchOptions,
  once((error, stats) => {
    if (error || stats.hasErrors()) return;
    nodemon({
      script: path.join(process.cwd(), '/build/index.js'),
      watch: path.join(process.cwd(), '/build/index.js'),
    }).on('quit', process.exit);
  }),
);
